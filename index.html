<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Cristiana & Tibi - Galerie</title>
<style>
  body {
    font-family: 'Arial', sans-serif;
    background: linear-gradient(135deg, #ffdde1, #ee9ca7);
    margin: 0;
    padding: 20px;
    color: #5a381e;
    text-align: center;
  }
  h1 {
    font-family: 'Great Vibes', cursive;
    font-size: 3em;
    margin-bottom: 10px;
  }
  #uploadBtn {
    padding: 12px 30px;
    font-size: 1.2em;
    border-radius: 50px;
    background: #ff4d6d;
    color: white;
    border: none;
    cursor: pointer;
    margin: 20px 0;
  }
  #preview {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 5px;
    justify-items: center;
  }
  #preview img, #preview video {
    width: 100%;
    height: 100px;
    object-fit: cover;
    border-radius: 8px;
    cursor: pointer;
    transition: transform 0.3s;
  }
  #preview img:hover, #preview video:hover {
    transform: scale(1.05);
  }
  /* Lightbox */
  #lightbox {
    position: fixed;
    display: none;
    top:0; left:0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.95);
    justify-content: center;
    align-items: center;
    z-index: 1000;
    overflow: hidden;
  }
  #lightbox img, #lightbox video {
    max-width: 95%;
    max-height: 95%;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
    transition: transform 0.3s;
  }
</style>
</head>
<body>

<h1>üíç Cristiana & Tibi</h1>

<input type="file" id="fileInput" accept="image/*,video/*" multiple style="display:none" />
<button id="uploadBtn">üì∏ √éncarcƒÉ poze sau videoclipuri</button>

<div id="preview"></div>

<!-- Lightbox -->
<div id="lightbox"></div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyAIeoK-hVEcb9ql1eX5ZzXBHCohuSZTAG4",
  authDomain: "cununie-54151.firebaseapp.com",
  projectId: "cununie-54151",
  storageBucket: "cununie-54151.firebasestorage.app",
  messagingSenderId: "847742419904",
  appId: "1:847742419904:web:36b2a2eefe57ed6cc03e25",
  measurementId: "G-808VQG01VC"
};

firebase.initializeApp(firebaseConfig);
const storage = firebase.storage();

const fileInput = document.getElementById('fileInput');
const uploadBtn = document.getElementById('uploadBtn');
const preview = document.getElementById('preview');
const lightbox = document.getElementById('lightbox');

uploadBtn.onclick = () => fileInput.click();

fileInput.onchange = async (e) => {
  const files = e.target.files;
  for(let file of files){
    const storageRef = storage.ref('uploads/' + file.name + '-' + Date.now());
    await storageRef.put(file);
  }
  alert('Fi»ôiere √ÆncƒÉrcate!');
  loadMedia();
};

async function loadMedia(){
  preview.innerHTML = '';
  const listRef = storage.ref('uploads');
  const res = await listRef.listAll();
  for(const itemRef of res.items){
    const url = await itemRef.getDownloadURL();
    let elem;
    if(itemRef.name.match(/\.(mp4|webm|ogg)$/i)){
      elem = document.createElement('video');
      elem.src = url;
      elem.controls = false;
      elem.muted = true;
      elem.loop = true;
      elem.autoplay = true;
    } else {
      elem = document.createElement('img');
      elem.src = url;
    }
    elem.addEventListener('click', (e) => openLightbox(elem, e));
    preview.appendChild(elem);
  }
}

// Lightbox cu anima»õie tip Instagram
function openLightbox(originalElem, event) {
  const rect = originalElem.getBoundingClientRect();
  const clone = originalElem.cloneNode(true);

  // Pozi»õioneazƒÉ clone exact peste thumbnail
  clone.style.position = 'fixed';
  clone.style.top = rect.top + 'px';
  clone.style.left = rect.left + 'px';
  clone.style.width = rect.width + 'px';
  clone.style.height = rect.height + 'px';
  clone.style.margin = 0;
  clone.style.zIndex = 1001;
  clone.style.borderRadius = '8px';
  clone.style.transition = 'all 0.3s ease';

  lightbox.innerHTML = '';
  lightbox.appendChild(clone);
  lightbox.style.display = 'flex';

  // Trigger animatie spre centru
  requestAnimationFrame(() => {
    clone.style.top = '50%';
    clone.style.left = '50%';
    clone.style.transform = 'translate(-50%, -50%)';
    clone.style.width = '95%';
    clone.style.height = 'auto';
    clone.style.borderRadius = '10px';
  });

  // Fullscreen direct
  openFullscreen(clone);

  // Click pe lightbox pentru √Ænchidere
  lightbox.onclick = () => {
    // Animatie inapoi
    clone.style.top = rect.top + 'px';
    clone.style.left = rect.left + 'px';
    clone.style.width = rect.width + 'px';
    clone.style.height = rect.height + 'px';
    clone.style.transform = 'translate(0,0)';
    clone.style.borderRadius = '8px';
    setTimeout(() => {
      closeFullscreen();
      lightbox.style.display = 'none';
    }, 300);
  };
}

// Fullscreen universal
function openFullscreen(elem) {
  if(elem.requestFullscreen) elem.requestFullscreen();
  else if(elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
  else if(elem.msRequestFullscreen) elem.msRequestFullscreen();
  else if(elem.webkitEnterFullscreen) elem.webkitEnterFullscreen(); // iOS video
  else { // fallback pentru imagini pe iOS
    if(document.documentElement.requestFullscreen) document.documentElement.requestFullscreen();
    else if(document.documentElement.webkitRequestFullscreen) document.documentElement.webkitRequestFullscreen();
  }
}

function closeFullscreen() {
  if(document.exitFullscreen) document.exitFullscreen();
  else if(document.webkitExitFullscreen) document.webkitExitFullscreen();
  else if(document.msExitFullscreen) document.msExitFullscreen();
}

loadMedia();
</script>

</body>
</html>
